<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>MofaCH</title>
    <link rel="stylesheet" href="index.css" />
    <!-- <script defer src="render.js"></script> -->
  </head>
  <body>
    <h1>MofaCH</h1>
    <p>
      MofaCH ist eine Platform, für alle Töfflibuebe und Töfflimeitli! Hier
      kannst du dein Mofa zeigen, hast einen Marktplatz, einen Tutorialbereich
      wo andere Nutzer hilfreiche Tutorials hochladen können und vieles mehr.
      Sei gespannt und entdecke MofaCH! Created by Colin
    </p>
    <div class="formgrid">
      <form>
        <input type="email" id="emailInput" placeholder="deine@email.com" />
        <input
          type="password"
          id="passwordInput"
          placeholder="deinPasswort123"
        />
        <button type="button" id="registerBTN">Registrieren</button>
        <button type="button" id="loginBTN">Anmelden</button>
        <button type="button" id="changeToRegister">
          Du hast noch keinen Account? KLICKE HIER!
        </button>
        <button type="button" id="changeToLogin">
          Du hast einen Account? KLICKE HIER!
        </button>
      </form>
    </div>
    <button id="closeBtn">Verlassen</button>

    <p id="userEmail"></p>
  </body>
</html>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-analytics.js";
  import {
    getAuth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
  } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyCWr3sEgXv2kJbUf-fUdQPc0Fl4PgcTf1I",
    authDomain: "mofach-49f97.firebaseapp.com",
    projectId: "mofach-49f97",
    storageBucket: "mofach-49f97.appspot.com",
    messagingSenderId: "239334965682",
    appId: "1:239334965682:web:820b4e5f1158c5b7cde4ab",
    measurementId: "G-36GK6STHNE",
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);

  let user;

  //on start show login inputs and buttons
  if (!user) {
    document.getElementById("registerBTN").style.display = "none";
    document.getElementById("loginBTN").style.display = "block";
    document.getElementById("changeToRegister").style.display = "block";
    document.getElementById("changeToLogin").style.display = "none";
  } else {
    document.getElementById("registerBTN").style.display = "none";
    document.getElementById("loginBTN").style.display = "none";
    document.getElementById("changeToRegister").style.display = "none";
    document.getElementById("changeToLogin").style.display = "none";
  }

  //when changeToRegister button clicked, show register button and inputs
  changeToRegister.addEventListener("click", (e) => {
    document.getElementById("registerBTN").style.display = "block";
    document.getElementById("loginBTN").style.display = "none";
    document.getElementById("changeToRegister").style.display = "none";
    document.getElementById("changeToLogin").style.display = "block";
  });
  //when changeToLogin button clicked, show login button and inputs
  changeToLogin.addEventListener("click", (e) => {
    document.getElementById("registerBTN").style.display = "none";
    document.getElementById("loginBTN").style.display = "block";
    document.getElementById("changeToRegister").style.display = "block";
    document.getElementById("changeToLogin").style.display = "none";
  });

  registerBTN.addEventListener("click", (e) => {
    let email = document.getElementById("emailInput").value;
    let password = document.getElementById("passwordInput").value;

    console.log(email);
    console.log(password);

    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // Signed up
        user = userCredential.user;
        document.getElementById("userEmail").textContent = user.email;
        // ...
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;
        // ..
      });
  });

  loginBTN.addEventListener("click", (e) => {
    let email = document.getElementById("emailInput").value;
    let password = document.getElementById("passwordInput").value;

    console.log(email);
    console.log(password);

    signInWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // Signed up
        user = userCredential.user;
        document.getElementById("userEmail").textContent = user.email;
        // ...
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;
        // ..
      });
  });

  document.getElementById("closeBtn").addEventListener("click", () => {
    // Send a message to request window closure
    window.api.send("quit");
  });
</script>
